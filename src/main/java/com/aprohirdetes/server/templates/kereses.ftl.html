<#include "html_header.ftl.html"/>
	<div class="container">
<#include "page_header_banner.ftl.html"/>
<#include "page_header.ftl.html"/>
<#include "container_search_form.ftl.html"/>
				<div class="row">
				<div class="col-sm-3 col-md-2"><#include "kereses_form.ftl"/></div>
				<div class="col-sm-9 col-md-10">
				<#if hibaUzenet?? >
					<div class="alert alert-danger">${hibaUzenet}</div>
				<#else>
					<div class="hirdeteslista-header">
						<#if (hirdetesek_szama>0) >
						<span>${hirdetesek_szama} apróhirdetés</span> - <span>${aktualisOldal}. oldal</span>
						<span style="float: right;">
							<a href="${rssUrl}" target="_blank" class="hidden-xs hidden-sm"><img alt="RSS" src="${app.contextRoot}/images/rss.png" border="0" width="20" height="20" /></a>
							<select id="keresesSorrendSelect">
								<option value="1" <#if sorrend==1>selected</#if>>Legújabb elöl</option>
								<option value="2" <#if sorrend==2>selected</#if>>Legrégebbi elöl</option>
								<option value="3" <#if sorrend==3>selected</#if>>Legolcsóbb elöl</option>
								<option value="4" <#if sorrend==4>selected</#if>>Legdrágább elöl</option>
							</select>
						</span>
						<#else>
						<span>Nincs a feltételeknek megfelelő hirdetés :-(</span>
						</#if>
					</div><!-- hirdeteslista-header -->
					<#assign sorszam = 1>
					<#list hirdetesList as hirdetes>
						<#include "lista_hirdetes.ftl.html">
						
						<#if (sorszam==5) >
						<!-- Hirdetes -->
						<script type="text/javascript" charset="utf-8" >
							//<![CDATA[
							var EtargetSearchQuery = '';//OPTIONAL_PAGE_URL
							
							var EtargetBannerIdent = 'ETARGET-hu-59362-728x90-IFRAME-8.2';
							var EtargetBannerStyle = '&tabl=4&design_name=custom&border_color=ffffff&border_style=none&background_opacity=100&background_color=ffffff&hover_back=&title_color=338be5&text_color=404040&url_color=338be5&h_title_color=338be5&h_text_color=404040&h_url_color=338be5&freespace=0&logo_type=0&logo=0&title_underline=0&url_underline=0&h_title_underline=1&h_url_underline=1&nourl=&fsi=11&font=verdana&require_login_pass=&login_pass=&show_in_fb=&show_in_fb_text=';
							var EtargetBannerDivid = '';
							
							function etargetBannerIdent(ident,style){this.ident=ident;var a=ident.split('-');this.country=a[1];this.ref=a[2];this.area=a[3];this.type=a[4];this.mod={};if(a.length>5){for(var i=5;i<a.length;i++)this.mod[a[i]]=1;};a=this.area.split('x');this.width=a[0];this.height=a[1];this.style={};a=style.split('&');for(var i=0;i<a.length;i++){var b=a[i].split('=');if(b.length>1)this.style[b[0]]=b[1];else this.style[b[0]]='';};this.q=document.location;var d=new Date();this.start=d.getTime();if(typeof(EtargetSearchQuery)=='string')if(EtargetSearchQuery!='')this.q=EtargetSearchQuery;this.getURL=function(){var u=location.protocol+'/'+'/'+this.country+'.search.etargetnet.com/generic/advert.php?g=ref:'+this.ref;u+=',area:'+this.width+'x'+this.height;for(var x in this.style){u+=','+x+':'+this.style[x];};var d=new Date();u+=',tt:'+Math.floor((d.getTime()-Number(this.start))/1000);u+=',q:'+encodeURIComponent(this.q);return u;},this.getIdent=function(){return this.ident;}};function etargetFindMyselfAndCreateOpener(ebi,setup){this.ebi=ebi;this.setup={domain:'',tstart:0,ref:0,start:{},treshold:{perc:30,func:null,cnt:1},click:true,measurement:'round',send:true,offset:0,debug:false};this.tresholds=0;if(typeof(setup)=='object'){for(var x in setup)this.setup[x]=setup[x];};this.objIn=function(o,n,options){var a=document.createElement(n);if(o.tagName=='SCRIPT'){o.parentNode.insertBefore(a,o);}else{o.appendChild(a);}for(var x in options){if(x.toUpperCase()==x){a.setAttribute(x.toLowerCase(),options[x]);}else if(x.indexOf('on')==0){a[x]==Function(options[x]);}else{a.style[x]=options[x];}}return a;},this.trigger=function(r){this.objIn(this.o,'script',{ASYNC:'async',SRC:this.ebi.getURL(),CHARSET:'utf-8'});this.o.style.height='auto';},this._getInternetExplorerVersion=function(){var rv=-1;if(navigator.appName=='Microsoft Internet Explorer'){var ua=navigator.userAgent;var re=new RegExp('MSIE ([0-9]{1,}[\.0-9]{0,})');if(re.exec(ua)!=null)rv=parseFloat(RegExp.$1);}return rv;},this.isIE=function(){if(typeof(this.browser)!='undefined')return (this.browser=='IE');var ver=this._getInternetExplorerVersion();if(ver>-1){this.browser='IE';return true;}else return false;},this.measure=function(){this.Screen={w:0,h:0,x:0,y:0,xx:0,yy:0};this.Window={w:0,h:0,x:0,y:0,xx:0,yy:0,minimized:false};if(typeof(window.outerWidth)!='undefined'){this.Window.w=window.outerWidth;this.Window.h=window.outerHeight;}else if(typeof(document.body.offsetWidth)!='undefined'){this.Window.w=document.body.offsetWidth;this.Window.h=document.body.offsetHeight;}if(typeof(window.screenTop)=='number'){if(window.screenTop<-32000)this.Window.minimized=true;this.Window.y=window.screenTop;}else if(typeof(window.screenY)=='number'){if(window.screenY<-32000)this.Window.minimized=true;this.Window.y=window.screenY;}if(!this.isIE())if((this.Window.w<100)&&(this.Window.h!=0))this.Window.minimized=true;if(typeof(window.innerWidth)=='number'){this.Screen.w=window.innerWidth;this.Screen.h=window.innerHeight;}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){this.Screen.w=document.documentElement.clientWidth;this.Screen.h=document.documentElement.clientHeight;}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){this.Screen.w=document.body.clientWidth;this.Screen.h=document.body.clientHeight;}if(typeof(window.pageYOffset)=='number'){this.Screen.x=window.pageXOffset;this.Screen.y=window.pageYOffset;}else if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){this.Screen.x=document.body.scrollLeft;this.Screen.y=document.body.scrollTop;}else if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){this.Screen.x=document.documentElement.scrollLeft;this.Screen.y=document.documentElement.scrollTop;}},this.update=function(){var p=this.o;this.x=0;this.y=0;this.xx=0;this.yy=0;if(!p)return false;this.h=p.offsetHeight;this.w=p.offsetWidth;while(p&&p.offsetParent){this.x+=p.offsetLeft;this.y+=p.offsetTop;p=p.offsetParent;}this.xx=Number(this.x+this.w);this.yy=Number(this.y+this.h);},this.percOnScreen=function(){this.measure();this.update();if(this.Window.minimized)return 0;var ofs=this.setup.offset;var x=this.x-ofs;var xx=this.xx+ofs;var y=this.y-ofs;var yy=this.yy+ofs;if(xx<this.Screen.x)return 0;if(yy<this.Screen.y)return 0;if(x>(this.Screen.w+this.Screen.x))return 0;if(y>(this.Screen.h+this.Screen.y))return 0;if(x<this.Screen.x)x=Number(this.Screen.x);if(y<this.Screen.y)y=Number(this.Screen.y);if(xx>(Number(this.Screen.w)+Number(this.Screen.x)))xx=(Number(this.Screen.w)+Number(this.Screen.x));if(yy>(Number(this.Screen.h)+Number(this.Screen.y)))yy=(Number(this.Screen.h)+Number(this.Screen.y));var w=Number(xx)-Number(x);var h=Number(yy)-Number(y);var full=this.w*this.h;var seen=w*h;if(full==0){var perc=100;}else{var perc=Math.round((Number(seen)/Number(full))*100);}return perc;},this.handleEvent=function(name){var perc=this.percOnScreen();if((perc>this.setup.treshold.perc)&&(this.tresholds<this.setup.treshold.cnt)){this.tresholds++;if(typeof(this.setup.treshold.func)=='function')this.setup.treshold.func(this);};},this.initHandle=function(n,f){if(this.isIE()){window.attachEvent('on'+n,f);}else{window.addEventListener(n,f,false);};},this.run=function(){var x='lkklk';var D=document;var aS=D.getElementsByTagName('script');var aB=D.getElementsByTagName('body');for(var i=0;i<aS.length;i++){try{if((aS[i].innerHTML.match(this.ebi.getIdent()))||((aS[i].src=='http:/'+'/'+x)||(aS[i].src=='https:/'+'/'+x))){var S=aS[i];if(EtargetBannerDivid!=''){var C=document.getElementById(EtargetBannerDivid);if(!C)return 0;this.o=this.objIn(C,'div',{margin:'0px',width:this.ebi.width+'px',height:this.ebi.height+'px'});}else if(aB.length<1){var B=D.createElement('body');D.documentElement.appendChild(B);B.style.margin='0px';B.style.borderWidth='0px';this.o=this.objIn(B,'div',{margin:'0px',width:this.ebi.width+'px',height:this.ebi.height+'px'});}else{this.o=this.objIn(S,'div',{margin:'auto',backgroundColor:'transparent',borderWidth:'0px',width:this.ebi.width+'px',height:this.ebi.height+'px'});}S.parentNode.removeChild(S);if(typeof(this.ebi.mod['instantOn'])!='undefined'){this.trigger(this);return 1;};var that=this;this.initHandle('scroll',function(){that.handleEvent();});this.setup.treshold.func=function(r){that.trigger(r);};this.handleEvent();return 1;break;}}catch(err){return 0;}};},this.init=function(){var that=this;this.initHandle('load',function(){that.run();});},this.init();};
							if(typeof(EtargetOpeners)=='undefined')EtargetOpeners=[];EtargetOpeners[EtargetOpeners.length]=new etargetFindMyselfAndCreateOpener(new etargetBannerIdent(EtargetBannerIdent,EtargetBannerStyle),{offset:50});
							//]]>
						</script>
						</#if>
						<#assign sorszam = sorszam + 1 >
					</#list>
					
					<#if (hirdetesek_szama>0) >
						<div>
							<ul class="pager">
								<#if (aktualisOldal>1) >
								<li class="previous"><a href="#" id="elozoBtn">&larr; Előző oldal</a></li>
								</#if>
								<#if (aktualisOldal<osszesOldal) >
								<li class="next"><a href="#" id="kovetkezoBtn">Még több apróhirdetés &rarr;</a></li>
								</#if>
							</ul>
						</div>
					</#if>
					</div>
				</div>
			    <script type="text/javascript">
				$('#keresesSorrendSelect').change(function(){
					window.s = this.value;
					window.p = 1;
					$('#btnKereses').click();
				});
	
				$('#elozoBtn').click(function(){
					if(window.p>1) {
						window.p--;
						$('#btnKereses').click();
					}
				});
				
				$('#kovetkezoBtn').click(function(){
					window.p++;
					$('#btnKereses').click();
				});
				
				function mentKedvenc(hirdetesId) {
					var data = {"hirdetesId":hirdetesId};
					
					$.ajax({
				        type: "POST",
				        url: "${app.contextRoot}/api/v1/kedvencek",
				        data: JSON.stringify(data),
				        contentType: "application/json; charset=utf-8",
				        dataType: "json"
					}).done(function(data){
						//alert(JSON.stringify(data));
						var id = data.hirdetesId;
						var i = document.getElementById("heart_" + hirdetesId);
						i.innerHTML = '<i class="fa fa-heart"></i>';
			        	i.href = "javascript:torolKedvenc('" + hirdetesId + "')";
			        	i.title = "Törlés a Kedvencekből";
			        }).fail(function(jqXHR, textStatus) {
			            alert(textStatus);
			        });
				}
				
				function torolKedvenc(hirdetesId) {
					var data = {"hirdetesId":hirdetesId};
					
					$.ajax({
				        type: "DELETE",
				        url: "${app.contextRoot}/api/v1/kedvencek/" + hirdetesId,
				        contentType: "application/json; charset=utf-8",
				        dataType: "json"
					}).done(function(data){
						//alert(JSON.stringify(data));
						var id = data.hirdetesId;
						var i = document.getElementById("heart_" + hirdetesId);
			        	i.innerHTML = '<i class="fa fa-heart-o"></i>';
			        	i.href = "javascript:mentKedvenc('" + hirdetesId + "')";
			        	i.title = "Hozzáadás a Kedvencekhez";
			        }).fail(function(jqXHR, textStatus) {
			            alert(textStatus);
			        });
				}
			    </script>
				</#if>
<#include "page_footer.ftl.html"/>
	</div>
<#include "html_footer.ftl.html"/>
